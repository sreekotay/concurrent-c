#include <ccc/cc_runtime.cch>

int main(void) {
    int[~3 >] tx;
    int[~3 <] rx;
    CCChan* ch = channel_pair(&tx, &rx);

    int v = 0;
    // Note: UFCS .send()/.recv() not used here due to parser limitation with statement expressions
    if (!cc_io_avail(chan_send(tx, 42))) return 1;
    if (!cc_io_avail(chan_recv(rx, &v))) return 2;
    if (v != 42) return 3;

    tx.close();  // UFCS works for void-returning methods
    cc_chan_free(ch);
    return 0;
}

