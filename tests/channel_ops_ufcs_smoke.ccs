#include <ccc/cc_runtime.cch>

int main(void) {
    int[~3 >] tx;
    int[~3 <] rx;
    CCChan* ch = channel_pair(&tx, &rx);

    int v = 0;
    if (tx.send(42) != 0) return 1;
    if (rx.recv(&v) != 0) return 2;
    if (v != 42) return 3;

    tx.close();
    cc_chan_free(ch);
    return 0;
}

