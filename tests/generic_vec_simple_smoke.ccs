/* Minimal test for Vec<int> generic syntax - NO UFCS VERSION */
#define CC_ENABLE_SHORT_NAMES
#include <ccc/std/prelude.cch>
#include <stdio.h>

int main(void) {
    CCArena arena = cc_arena_heap(kilobytes(4));
    if (!arena.base) return 1;

    /* Use Vec<int> generic syntax - triggers codegen declaration */
    Vec<int> v = vec_new<int>(&arena);
    
    /* Use explicit function calls (no UFCS) */
    Vec_int_push(&v, 10);
    Vec_int_push(&v, 20);
    Vec_int_push(&v, 30);
    
    if (Vec_int_len(&v) != 3) {
        fprintf(stderr, "FAIL: expected len=3\n");
        return 2;
    }
    
    /* Test optional-returning get with explicit call */
    int? val = Vec_int_get(&v, 0);
    if (!val.has) {
        fprintf(stderr, "FAIL: get returned None\n");
        return 3;
    }
    if (*val != 10) {
        fprintf(stderr, "FAIL: expected 10\n");
        return 4;
    }

    printf("generic_vec_simple_smoke ok\n");
    
    cc_arena_free(&arena);
    return 0;
}
