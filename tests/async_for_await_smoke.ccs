#include <ccc/cc_runtime.cch>
#include <ccc/std/task_intptr.cch>

static int add1(int x) { return x + 1; } /* sync */

@async int f(void) {
    int i = 0;
    int sum = 0;
    for (i = 0; i < 3; i = i + 1) {
        if (i == 0) {
            sum = add1(sum);
        } else {
            sum = add1(sum);
        }
    }
    return sum;
}

int main(void) {
    int r = cc_block_on(int, f());
    return (r == 3) ? 0 : 1;
}

