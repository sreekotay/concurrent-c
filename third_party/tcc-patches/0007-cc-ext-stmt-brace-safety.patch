diff --git a/tccgen.c b/tccgen.c
index cdcdcdcd..efefefef 100644
--- a/tccgen.c
+++ b/tccgen.c
@@ -7362,6 +7362,11 @@ again:
 #ifdef CONFIG_CC_EXT
+    /* CC extension safety: if a statement-level parse consumed up to a closing brace,
+       bail out instead of treating '}' as a statement token. */
+    if ((flags & STMT_COMPOUND) && tok == '}')
+        return;
     /* CC extension: allow external parser to consume statements. If handled,
        it must leave `tok` pointing at the next token after the statement. */
     if (tcc_state->ext_parser && tcc_state->ext_parser->try_cc_stmt) {
